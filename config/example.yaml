id: 1be50fe6-0dbf-4341-8836-73b23dbee2a1
storageBackends: []
sources:
- id: vehicle-location-source
  kind: mock
  autoStart: true
  intervalSeconds: 5
  dataType: vehicle_location
  description: Mock vehicle location data
- id: order-status-source
  kind: mock
  autoStart: true
  dataType: order_status
  intervalSeconds: 3
  description: Mock order status updates
queries:
- id: available-drivers-query
  query: "\n            MATCH (d:Driver {status: 'available'})\n            WHERE d.latitude IS NOT NULL AND d.longitude IS NOT NULL\n            RETURN elementId(d) AS driverId, d.driver_name AS driverName,\n                   d.latitude AS lat, d.longitude AS lng, d.status AS status\n        "
  queryLanguage: Cypher
  middleware: []
  sources:
  - source_id: vehicle-location-source
    pipeline: []
  auto_start: true
  enableBootstrap: true
  bootstrapBufferSize: 10000
- id: pending-orders-query
  query: "\n            MATCH (o:Order)\n            WHERE o.status IN ['pending', 'preparing', 'ready']\n            RETURN elementId(o) AS orderId, o.status AS status,\n                   o.restaurant AS restaurant, o.delivery_address AS address\n        "
  queryLanguage: Cypher
  middleware: []
  sources:
  - source_id: vehicle-location-source
    pipeline: []
  auto_start: true
  enableBootstrap: true
  bootstrapBufferSize: 10000
reactions:
- id: driver-availability-logger
  kind: log
  queries:
  - available-drivers-query
  autoStart: true
  logLevel: info
  description: Log driver availability changes
- id: order-notification-handler
  kind: http
  queries:
  - available-drivers-query
  autoStart: true
  endpoint: http://localhost:9000/notifications
  method: POST
  description: Send notifications for query results
